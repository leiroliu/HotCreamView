<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>站内信</title>


    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">

    <!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap-theme.min.css" integrity="sha384-6pzBo3FDv/PJ8r2KRkGHifhEocL+1X2rVCTTkUfGk7/0pbek5mMa1upzvWbrUbOZ" crossorigin="anonymous">

</head>
<body>
<div>
    <div class="container-fluid">
        <div class="row-fluid">
            <div class="span2">
            </div>
            <div class="span6">
                <h3>
                    站内信
                </h3>
                <ul class="nav nav-tabs">
                    <li class="active">
                        <a href="javascript:selectTable('myReceivMsg')">我的消息</a>
                    </li>
                    <li>
                        <a href="javascript:selectTable('myDartMsg')">草稿箱</a>
                    </li>
                    <li class="disabled">
                        <a href="javascript:selectTable('withdrawMsg')">已撤回的</a>
                    </li>
                    <li class="dropdown pull-right">
                        <a class="btn-lg" href="javascript:createMsg()">新建消息</a>
                    </li>
                </ul>
                <form class="form-search">
                    <input class="input-medium search-query" id="receiveMsgKeyWord" type="text" /> <button type="button" onclick="queryReceiveMsg()" class="btn">查找</button>
                </form>
                <div id="myReceivMsg" style="display:none;">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>
                                标题
                            </th>
                            <th>
                                简略信息
                            </th>
                            <th>
                                发送人
                            </th>
                            <th>
                                发送时间
                            </th>
                            <th>
                                操作
                            </th>
                        </tr>
                        </thead>
                        <tbody id="receiveMsgTableList">

                        </tbody>
                    </table>
                </div>
                <div id="myDartMsg" style="display:none;">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>
                                标题
                            </th>
                            <th>
                                简略信息
                            </th>
                            <th>
                                创建时间
                            </th>
                            <th>
                                最后修改时间
                            </th>
                            <th>
                                操作
                            </th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>
                                1
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                01/04/2012
                            </td>
                            <td>
                                Default
                            </td>
                        </tr>
                        <tr class="success">
                            <td>
                                1
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                01/04/2012
                            </td>
                            <td>
                                Approved
                            </td>
                        </tr>
                        <tr class="error">
                            <td>
                                2
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                02/04/2012
                            </td>
                            <td>
                                Declined
                            </td>
                        </tr>
                        <tr class="warning">
                            <td>
                                3
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                03/04/2012
                            </td>
                            <td>
                                Pending
                            </td>
                        </tr>
                        <tr class="info">
                            <td>
                                4
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                04/04/2012
                            </td>
                            <td>
                                Call in to confirm
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <div id="withdrawMsg" style="display:none;">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>
                                标题
                            </th>
                            <th>
                                发送人
                            </th>
                            <th>
                                接收人
                            </th>
                            <th>
                                撤回时间
                            </th>
                            <th>
                                操作
                            </th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>
                                1
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                01/04/2012
                            </td>
                            <td>
                                Default
                            </td>
                        </tr>
                        <tr class="success">
                            <td>
                                1
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                01/04/2012
                            </td>
                            <td>
                                Approved
                            </td>
                        </tr>
                        <tr class="error">
                            <td>
                                2
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                02/04/2012
                            </td>
                            <td>
                                Declined
                            </td>
                        </tr>
                        <tr class="warning">
                            <td>
                                3
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                03/04/2012
                            </td>
                            <td>
                                Pending
                            </td>
                        </tr>
                        <tr class="info">
                            <td>
                                4
                            </td>
                            <td>
                                TB - Monthly
                            </td>
                            <td>
                                04/04/2012
                            </td>
                            <td>
                                Call in to confirm
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="span4">
            </div>
        </div>
    </div>
</div>

<script>

    window.onload=function (){
        initMsgTable();
        selectTable('myReceivMsg')
    }
    function initMsgTable(){
        var tableIds = ["myReceivMsg", "myDartMsg", "withdrawMsg"];
        for(var i=0;i<tableIds.length;i++){
            $("#"+tableIds[i]).hide();
        }
    }
    function selectTable(viId){
        initMsgTable();
        $("#"+viId).show();
    }

    function queryReceiveMsg(){
        var keyWord = $('#receiveMsgKeyWord').val();
        post("/message/queryMyReceiverMsg", {"keyWord":keyWord},function (data){
            data = eval(data);
            if(data.code === API_CODE_SUCCESS){
                var htmlStr = displayTable(data.data);
                $('#receiveMsgTableList')[0].innerHTML = htmlStr;
            }else {
                alert(data.info);
            }

        })

    }

    function displayTable(datList){
        var trs = "";
        for(var i=0;i<datList.length;i++){
            var row = datList[i];
            var line = " <tr class=\"info\">\n" +
                "                            <td>\n" +
                row.msgTitle +
                "                            </td>\n" +
                "                            <td>\n" +
                row.shortMsgBody +
                "                            </td>\n" +
                "                            <td>\n" +
                row.sender +
                "                            </td>\n" +
                "                            <td>\n" +
                row.sendTime  +
                "                            </td>\n" +
                "                        </tr>";
            trs += line;
        }
        return trs;
    }

</script>

<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>
<script src="js/apiutils.js" type="text/javascript"></script>


</body>
</html>